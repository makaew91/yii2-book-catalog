<?php

use yii\db\Migration;

class m251128_185223_seed_test_data extends Migration
{
    /**
     * {@inheritdoc}
     */
    public function safeUp(): void
    {
        $time = time();

        // Авторы
        $this->batchInsert('{{%author}}', ['full_name', 'created_at', 'updated_at'], [
            ['Толстой Лев Николаевич', $time, $time],
            ['Достоевский Фёдор Михайлович', $time, $time],
            ['Пушкин Александр Сергеевич', $time, $time],
            ['Чехов Антон Павлович', $time, $time],
            ['Гоголь Николай Васильевич', $time, $time],
        ]);

        // Книги
        $this->batchInsert('{{%book}}', ['title', 'year', 'description', 'isbn', 'created_at', 'updated_at'], [
            ['Война и мир', 1869, 'Роман-эпопея Льва Толстого', '978-5-17-098640-7', $time, $time],
            ['Анна Каренина', 1877, 'Роман Льва Толстого', '978-5-17-098641-4', $time, $time],
            ['Преступление и наказание', 1866, 'Роман Достоевского', '978-5-17-098642-1', $time, $time],
            ['Идиот', 1869, 'Роман Достоевского', '978-5-17-098643-8', $time, $time],
            ['Евгений Онегин', 1833, 'Роман в стихах Пушкина', '978-5-17-098644-5', $time, $time],
            ['Капитанская дочка', 1836, 'Повесть Пушкина', '978-5-17-098645-2', $time, $time],
            ['Вишнёвый сад', 1904, 'Пьеса Чехова', '978-5-17-098646-9', $time, $time],
            ['Мёртвые души', 1842, 'Поэма Гоголя', '978-5-17-098647-6', $time, $time],
        ]);

        // Связи книга-автор
        $this->batchInsert('{{%book_author}}', ['book_id', 'author_id'], [
            [1, 1], // Война и мир - Толстой
            [2, 1], // Анна Каренина - Толстой
            [3, 2], // Преступление и наказание - Достоевский
            [4, 2], // Идиот - Достоевский
            [5, 3], // Евгений Онегин - Пушкин
            [6, 3], // Капитанская дочка - Пушкин
            [7, 4], // Вишнёвый сад - Чехов
            [8, 5], // Мёртвые души - Гоголь
        ]);
    }

    /**
     * {@inheritdoc}
     */
    public function safeDown(): void
    {
        $this->truncateTable('{{%book_author}}');
        $this->truncateTable('{{%book}}');
        $this->truncateTable('{{%author}}');
    }
}
