# API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - –ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥

## –ë–∞–∑–æ–≤—ã–π URL
```
http://localhost:8000
```

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üìö –ö–Ω–∏–≥–∏

#### GET /api/books
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–Ω–∏–≥ (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl http://localhost:8000/api/books
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "title": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä",
    "year": 1869,
    "description": "–†–æ–º–∞–Ω-—ç–ø–æ–ø–µ—è –õ—å–≤–∞ –¢–æ–ª—Å—Ç–æ–≥–æ",
    "isbn": "978-5-17-098640-7",
    "cover_image_path": null,
    "created_at": 1764355970,
    "updated_at": 1764355970
  }
]
```

#### GET /api/books/{id}
–ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É –ø–æ ID (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl http://localhost:8000/api/books/1
```

#### POST /api/books
–°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X POST http://localhost:8000/api/books \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–ù–æ–≤–∞—è –∫–Ω–∏–≥–∞",
    "year": 2024,
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∫–Ω–∏–≥–∏",
    "isbn": "978-5-17-098648-3",
    "authorIds": [1, 2]
  }'
```

**–û—Ç–≤–µ—Ç 403 –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω:**
```json
{
  "name": "Forbidden",
  "message": "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è",
  "code": 0,
  "status": 403
}
```

#### PUT /api/books/{id}
–û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X PUT http://localhost:8000/api/books/1 \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
    "year": 2024
  }'
```

#### DELETE /api/books/{id}
–£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X DELETE http://localhost:8000/api/books/1
```

---

### üë• –ê–≤—Ç–æ—Ä—ã

#### GET /api/authors
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl http://localhost:8000/api/authors
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "full_name": "–¢–æ–ª—Å—Ç–æ–π –õ–µ–≤ –ù–∏–∫–æ–ª–∞–µ–≤–∏—á",
    "created_at": 1764355970,
    "updated_at": 1764355970
  }
]
```

#### GET /api/authors/{id}
–ü–æ–ª—É—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ –ø–æ ID (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl http://localhost:8000/api/authors/1
```

#### POST /api/authors
–°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X POST http://localhost:8000/api/authors \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
  }'
```

#### PUT /api/authors/{id}
–û–±–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X PUT http://localhost:8000/api/authors/1 \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "–û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –§–ò–û"
  }'
```

#### DELETE /api/authors/{id}
–£–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)

```bash
curl -X DELETE http://localhost:8000/api/authors/1
```

---

### üîî –ü–æ–¥–ø–∏—Å–∫–∏

#### POST /api/subscription
–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∞–≤—Ç–æ—Ä–∞ (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl -X POST http://localhost:8000/api/subscription \
  -H "Content-Type: application/json" \
  -d '{
    "author_id": 1,
    "phone": "+79991234567"
  }'
```

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞"
}
```

**–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ (–æ—à–∏–±–∫–∞):**
```json
{
  "success": false,
  "errors": {
    "phone": [
      "–í—ã —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç–æ–≥–æ –∞–≤—Ç–æ—Ä–∞."
    ]
  }
}
```

---

### üìä –û—Ç—á—ë—Ç—ã

#### GET /api/report/top-authors?year={year}
–ü–æ–ª—É—á–∏—Ç—å –¢–û–ü-10 –∞–≤—Ç–æ—Ä–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥ (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)

```bash
curl "http://localhost:8000/api/report/top-authors?year=1869"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "year": 1869,
  "authors": [
    {
      "id": 1,
      "full_name": "–¢–æ–ª—Å—Ç–æ–π –õ–µ–≤ –ù–∏–∫–æ–ª–∞–µ–≤–∏—á",
      "created_at": 1764355970,
      "updated_at": 1764355970,
      "book_count": 1
    },
    {
      "id": 2,
      "full_name": "–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§—ë–¥–æ—Ä –ú–∏—Ö–∞–π–ª–æ–≤–∏—á",
      "created_at": 1764355970,
      "updated_at": 1764355970,
      "book_count": 1
    }
  ]
}
```

–ï—Å–ª–∏ `year` –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –≥–æ–¥.

---

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ì–æ—Å—Ç—å (–Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω):
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥ (GET /api/books, GET /api/books/{id})
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–≤—Ç–æ—Ä–æ–≤ (GET /api/authors, GET /api/authors/{id})
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∞–≤—Ç–æ—Ä–∞ (POST /api/subscription)
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á—ë—Ç–∞ (GET /api/report/top-authors)
- ‚ùå CRUD –∫–Ω–∏–≥ –∏ –∞–≤—Ç–æ—Ä–æ–≤ (–≤–µ—Ä–Ω—ë—Ç 403)

### –Æ–∑–µ—Ä (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω):
- ‚úÖ –í—Å—ë, —á—Ç–æ –¥–æ—Å—Ç—É–ø–Ω–æ –≥–æ—Å—Ç—é
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–∏–≥ (POST /api/books)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥ (PUT /api/books/{id})
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∫–Ω–∏–≥ (DELETE /api/books/{id})
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ (POST /api/authors)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ (PUT /api/authors/{id})
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ (DELETE /api/authors/{id})

---

## SMS –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ `POST /api/books` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è SMS-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º –∞–≤—Ç–æ—Ä–æ–≤ —ç—Ç–æ–π –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ **smspilot.ru** (–∫–ª—é—á `emulator`, —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Ç).

–õ–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ `runtime/logs/app.log`.

---

## –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–í –±–∞–∑–µ –µ—Å—Ç—å 8 –∫–Ω–∏–≥ –∏ 5 –∞–≤—Ç–æ—Ä–æ–≤:
- –¢–æ–ª—Å—Ç–æ–π (2 –∫–Ω–∏–≥–∏: 1869, 1877)
- –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π (2 –∫–Ω–∏–≥–∏: 1866, 1869)
- –ü—É—à–∫–∏–Ω (2 –∫–Ω–∏–≥–∏: 1833, 1836)
- –ß–µ—Ö–æ–≤ (1 –∫–Ω–∏–≥–∞: 1904)
- –ì–æ–≥–æ–ª—å (1 –∫–Ω–∏–≥–∞: 1842)

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–æ–¥–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose ps

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã)
docker-compose exec php php yii migrate/up --interactive=0
```

API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8000**

